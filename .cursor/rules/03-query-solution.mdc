---
alwaysApply: false
---

현재 키워드 분석 서비스에서 N+1 쿼리 문제와 비효율적인 데이터 저장이 발생하고 있습니다.

다음 문제들을 해결해주세요:

**문제점:**
1. 연관 키워드 저장 시 개별 쿼리 실행 (N+1 문제)
2. 차트 데이터 조회 시 6개의 개별 쿼리 실행
3. UPSERT 로직이 복잡하고 에러 발생 가능성 높음
4. 트랜잭션 관리 부족으로 데이터 일관성 문제

**해결 방안:**
- 배치 INSERT/UPDATE 구현
- 단일 쿼리로 차트 데이터 조회 최적화
- 트랜잭션 래퍼 서비스 구현
- 데이터베이스 인덱스 최적화

**파일 수정:**
- `src/modules/keyword-analysis/keyword-analysis.service.ts` (144-194줄, 222-292줄)
- `src/database/entities/*.entity.ts` (인덱스 추가)

**성능 목표:** 데이터 저장 시간 70% 단축현재 키워드 분석 서비스에서 N+1 쿼리 문제와 비효율적인 데이터 저장이 발생하고 있습니다.

다음 문제들을 해결해주세요:

**문제점:**
1. 연관 키워드 저장 시 개별 쿼리 실행 (N+1 문제)
2. 차트 데이터 조회 시 6개의 개별 쿼리 실행
3. UPSERT 로직이 복잡하고 에러 발생 가능성 높음
4. 트랜잭션 관리 부족으로 데이터 일관성 문제

**해결 방안:**
- 배치 INSERT/UPDATE 구현
- 단일 쿼리로 차트 데이터 조회 최적화
- 트랜잭션 래퍼 서비스 구현
- 데이터베이스 인덱스 최적화

**파일 수정:**
- `src/modules/keyword-analysis/keyword-analysis.service.ts` (144-194줄, 222-292줄)
- `src/database/entities/*.entity.ts` (인덱스 추가)

**성능 목표:** 데이터 저장 시간 70% 단축